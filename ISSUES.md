# HmGoogleLangTranslator の問題点 (Issues)

このプロジェクトには、いくつかの問題点が存在します。特に、根本的な機能に関わる致命的な問題が含まれているため、現状のままでは使用することができません。

## 1. 【致命的】翻訳機能の停止

このマクロの中核である Google Apps Script の `LanguageApp.translate()` サービスは、**2020年8月1日にGoogleによって非推奨となり、すでにサービスが停止されています。**

- **影響:** このマクロを実行しても翻訳は行われず、エラーが発生します。
- **解決策:** Googleが提供する後継の **Google Cloud Translation API** を利用するように、マクロとGoogle Apps Scriptの両方を修正する必要があります。ただし、こちらは有料サービスとなり、APIキーの取得など、より複雑な設定が求められます。

## 2. 技術的な問題点

### Content-Type ヘッダの不一致

- **問題:** マクロからGoogle Apps Scriptへデータを送信する際、`Content-Type` ヘッダが `application/x-www-form-urlencoded` となっていますが、実際に送信されているデータはJSON形式です。
- **影響:** Google Apps Script側の仕様の寛容さにより偶然動作する可能性もありますが、これは技術的に正しくなく、予期せぬエラーの原因となり得ます。正しくは `application/json; charset=UTF-8` とすべきです。

## 3. ユーザビリティに関する改善提案

### APIエンドポイントの設定方法

- **問題:** 現在、APIのURLを設定する主要な方法が環境変数 (`GOOGLE_SCRIPT_TRANSLATION_API`) となっています。これは一般的なPCユーザー、特に秀丸エディタのユーザー層にとっては設定のハードルが高い可能性があります。
- **提案:** 設定を外部の `.ini` ファイルに切り出すか、マクロ実行時にユーザーに入力を促すダイアログを表示する形式にすることで、より多くのユーザーが簡単に利用できるようになります。

### ドキュメントの陳腐化

- **問題:** `README.md` や公式サイトのドキュメントには、`LanguageApp` サービスがすでに停止していることについての記述がありません。現在の記述通りに設定を進めてもマクロが動作しないため、ユーザーを混乱させてしまいます。
- **提案:** サービスが利用不可であることを明確に記載し、代替策（Cloud Translation APIへの移行など）を案内するよう、ドキュメントを更新する必要があります。

## 4. その他の改善点

- **エラーハンドリング:** サービス停止のような根本的な原因がユーザーに伝わるよう、より具体的なエラーメッセージを表示する改善が望まれます。
- **セキュリティ:** ドキュメントで案内されているGoogle Apps Scriptの「全員に公開」設定は、誰でもAPIを叩ける状態となり、セキュリティリスクを伴う可能性があります。ユーザー自身がリスクを理解した上で設定できるよう、セキュリティに関する注意喚起を追記することが推奨されます。
